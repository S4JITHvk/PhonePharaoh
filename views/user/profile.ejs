
<%-include('../partials/userHeader') %>

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
        crossorigin="anonymous" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

</head>

<body>
    <section>
        <div class="container-fluid ">
            <div class="row justify-content-center">
                <div class="col-md-8 mt-5">
                    <div class="card shadow border">
                        <div class="card-body">
                            <form id="profileForm">
                                <div class="p-3 py-5">
                                    <div class="d-flex justify-content-center align-items-center mb-3">
                                        <h3 class="text-right">Profile Settings</h3>
                                    </div>
                                    <div class="mb-3">
                                        <label class="labels">Name</label>
                                        <input type="text" class="form-control" placeholder="Name" id="name"
                                            value="<%= profile.userName %>" />
                                            <span id="nameError" class="text-danger"></span>
                                    </div>
                                    <!-- Inside the form -->
<div class="mb-3">
  <label class="labels">Email</label>
  <input type="email" class="form-control" placeholder="Email" id="email" value="<%= profile.email %>" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" title="Enter a valid email address" required />
  <span id="emailError" class="text-danger"></span>
</div>


                                    <br>
                                    <div class="d-flex justify-content-around">
                                        <div class="cardHeader d-flex">
                                            <button type="submit" class="btn btn-dark">Save Changes</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="card shadow border">
                  <div class="card-body d-flex row justify-content-center">
              
                      <div class="col-md-2 m-2">
                          <div class="card shadow border ">
                              <div class="card-body  justify-content-center">
                                  <a href="/trackOrder" style="text-decoration: none; color: black;">
                                      <i class="fa-solid fa-clock-rotate-left fa-2xl" style="color: #000000"></i>
                                      <br>
                                      <h5>Orders</h5>
                                  </a>
                              </div>
                          </div>
                      </div>
              
                      <div class="col-md-2 m-2">
                          <div class="card shadow border">
                              <div class="card-body">
                                  <a href="/user/cart" style="text-decoration: none; color: black;">
                                      <i class="fa-solid fa-cart-shopping fa-2xl" style="color: #000000"></i>
                                      <h5>Cart</h5>
                                  </a>
                              </div>
                          </div>
                      </div>
              
                      <div class="col-md-2 m-2">
                          <div class="card shadow border">
                              <div class="card-body">
                                  <a href="/address" style="text-decoration: none; color: black;">
                                      <i class="fa-solid fa-location-dot fa-2xl" style="color: #00060f"></i>
                                      <h5>Address</h5>
                                  </a>
                              </div>
                          </div>
                      </div>
              
                      <div class="col-md-2 m-2">
                          <div class="card shadow border">
                              <div class="card-body">
                                  <a href="/user/wishlist" style="text-decoration: none; color: black;">
                                      <i class="fa-solid fa-heart fa-2xl" style="color: #000000"></i>
                                      <h5>Wishlist</h5>
                                  </a>
                              </div>
                          </div>
                      </div>
              
                      <div class="col-md-2 m-2">
                          <div class="card shadow border">
                              <div class="card-body">
                                  <a href="/user/coupon" style="text-decoration: none; color: black;">
                                      <i class="fa-solid fa fa-gift fa-2xl" style="color: #000000"></i>
                                      <h5>Coupon</h5>
                                  </a>
                              </div>
                          </div>
                      </div>
              
                  </div>
              </div>
              
            </div>
        </div>
    </section>
    <br>
    <br>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
        crossorigin="anonymous"></script>

        <script>
          document.getElementById('profileForm').addEventListener('submit', function (event) {
              event.preventDefault();
      
              const name = document.getElementById('name').value;
              const email = document.getElementById('email').value;
              const emailError = document.getElementById('emailError');
              const nameError = document.getElementById('nameError');
              if (name.trim() === '') {
            nameError.textContent = 'Please enter a name.';
            return; // Stop form submission
        }
              // Validate email
              const emailRegex = /^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$/i;
              if (!emailRegex.test(email)) {
                  emailError.textContent = 'Please enter a valid email address.';
                  return; // Stop form submission
              }
               
              // Clear previous error messages
              emailError.textContent = '';
              nameError.textContent = '';
              // Continue with form submission
              const formData = {
                  name: name,
                  email: email,
              };
      
              fetch('/updateProfile', {
                  method: 'POST',
                  headers: {
                      'Content-Type': 'application/json',
                  },
                  body: JSON.stringify(formData),
              })
                  .then(response => response.json())
                  .then(data => {
                      if (data.success) {
                          alert('Profile updated successfully!');
                          setTimeout(() => {
                              window.location.reload();
                          }, 1000);
                      } else {
                          alert('Failed to update profile.');
                      }
                  })
                  .catch(error => {
                      console.error('Error:', error);
                  });
          });
      </script>
      

    <%-include('../partials/userFooter') %>
